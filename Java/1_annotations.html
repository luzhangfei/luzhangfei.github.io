<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JAVA 注解 | 卢章斐的笔记</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.cc2a2ebf.css" as="style"><link rel="preload" href="/assets/js/app.87228582.js" as="script"><link rel="preload" href="/assets/js/6.1efe7eb3.js" as="script"><link rel="prefetch" href="/assets/js/2.413b4e91.js"><link rel="prefetch" href="/assets/js/3.ba107937.js"><link rel="prefetch" href="/assets/js/4.a48cfc41.js"><link rel="prefetch" href="/assets/js/5.6101a530.js"><link rel="prefetch" href="/assets/js/7.de8dbbc3.js"><link rel="prefetch" href="/assets/js/8.12e5cbd6.js"><link rel="prefetch" href="/assets/js/9.e8c58117.js"><link rel="prefetch" href="/assets/js/10.3fe4b9c5.js"><link rel="prefetch" href="/assets/js/11.8d92cab9.js"><link rel="prefetch" href="/assets/js/12.391a92c7.js"><link rel="prefetch" href="/assets/js/13.d7a5a6d1.js"><link rel="prefetch" href="/assets/js/14.9295d419.js"><link rel="prefetch" href="/assets/js/15.ca5b5f04.js"><link rel="prefetch" href="/assets/js/16.f174bfff.js"><link rel="prefetch" href="/assets/js/17.f00fd2b5.js"><link rel="prefetch" href="/assets/js/18.03d4acc8.js"><link rel="prefetch" href="/assets/js/19.4e9576b6.js"><link rel="prefetch" href="/assets/js/20.28699996.js"><link rel="prefetch" href="/assets/js/21.d9946966.js"><link rel="prefetch" href="/assets/js/22.39b5f7f3.js"><link rel="prefetch" href="/assets/js/23.87fc2815.js"><link rel="prefetch" href="/assets/js/24.6f267493.js"><link rel="prefetch" href="/assets/js/25.95bc8e2f.js"><link rel="prefetch" href="/assets/js/26.71267169.js"><link rel="prefetch" href="/assets/js/27.942e7ee8.js"><link rel="prefetch" href="/assets/js/28.7bff9205.js"><link rel="prefetch" href="/assets/js/29.44a073d8.js"><link rel="prefetch" href="/assets/js/30.5cb9be55.js"><link rel="prefetch" href="/assets/js/31.fd2f60ac.js"><link rel="prefetch" href="/assets/js/32.2f243f4c.js"><link rel="prefetch" href="/assets/js/33.ee7dd030.js"><link rel="prefetch" href="/assets/js/34.1000dd23.js"><link rel="prefetch" href="/assets/js/35.021f8629.js"><link rel="prefetch" href="/assets/js/36.002ba0cd.js"><link rel="prefetch" href="/assets/js/37.6edc899c.js"><link rel="prefetch" href="/assets/js/38.b63acc28.js"><link rel="prefetch" href="/assets/js/39.3d1bcdb5.js"><link rel="prefetch" href="/assets/js/40.1b7124fc.js"><link rel="prefetch" href="/assets/js/41.75fb759f.js"><link rel="prefetch" href="/assets/js/42.a3455701.js"><link rel="prefetch" href="/assets/js/43.b47b17c9.js"><link rel="prefetch" href="/assets/js/44.5bd8d19e.js"><link rel="prefetch" href="/assets/js/45.b49eaf0c.js"><link rel="prefetch" href="/assets/js/46.ef65ee01.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cc2a2ebf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">卢章斐的笔记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Java/" class="nav-link router-link-active">Java</a></div><div class="nav-item"><a href="/JavaScript/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/Tools/" class="nav-link">Tools</a></div><div class="nav-item"><a href="/DataBase/" class="nav-link">DataBase</a></div><div class="nav-item"><a href="/Other/" class="nav-link">Other</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Java/" class="nav-link router-link-active">Java</a></div><div class="nav-item"><a href="/JavaScript/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/Tools/" class="nav-link">Tools</a></div><div class="nav-item"><a href="/DataBase/" class="nav-link">DataBase</a></div><div class="nav-item"><a href="/Other/" class="nav-link">Other</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Java/1_annotations.html" class="active sidebar-link">注解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/1_annotations.html#注解的作用" class="sidebar-link">注解的作用</a></li><li class="sidebar-sub-header"><a href="/Java/1_annotations.html#标准注解" class="sidebar-link">标准注解</a></li><li class="sidebar-sub-header"><a href="/Java/1_annotations.html#注解的基本语法" class="sidebar-link">注解的基本语法</a></li><li class="sidebar-sub-header"><a href="/Java/1_annotations.html#准备工作" class="sidebar-link">准备工作</a></li><li class="sidebar-sub-header"><a href="/Java/1_annotations.html#使用反射方式实现" class="sidebar-link">使用反射方式实现</a></li></ul></li><li><a href="/Java/2_reflect.html" class="sidebar-link">反射</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SpringBoot</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="java-注解"><a href="#java-注解" aria-hidden="true" class="header-anchor">#</a> JAVA 注解</h1> <p>注解也被称为元数据，是Java SE5引入的重要的语言变化一，注解的出现为我们在代码中添加信息提供来了一种形式化的方法，使我们可以在稍后的某个时刻方便的使用这些数据。</p> <h2 id="注解的作用"><a href="#注解的作用" aria-hidden="true" class="header-anchor">#</a> 注解的作用</h2> <ul><li>生成描述符文件。</li> <li>新的类定义。</li> <li>减轻编写“样板”代码的负担。</li> <li>使代码干净易读。</li> <li>可以在编译期进行类型检查。</li> <li>。。。。。。</li></ul> <h2 id="标准注解"><a href="#标准注解" aria-hidden="true" class="header-anchor">#</a> 标准注解</h2> <p>Java为我们提供了三种标准化的注解，见以下表格：</p> <table><thead><tr><th style="text-align:left">注解标识</th> <th style="text-align:left">作用</th></tr></thead> <tbody><tr><td style="text-align:left">@Override</td> <td style="text-align:left">表示当前的方法定义覆盖超类中的方法，如果一不小心拼写错误，或者签名方法对不上被覆盖的方法，编译器就会发生错误。</td></tr> <tr><td style="text-align:left">@Deprecated</td> <td style="text-align:left">如果使用了注解为它的元素，编译器会发出警告信息</td></tr> <tr><td style="text-align:left">@SuppressWarnings</td> <td style="text-align:left">关闭不当的编译器警告信息</td></tr></tbody></table> <h2 id="注解的基本语法"><a href="#注解的基本语法" aria-hidden="true" class="header-anchor">#</a> 注解的基本语法</h2> <p>定义一个Test注解：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">.</span>METHOD<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">MyAnnotation</span> <span class="token punctuation">{</span>
     <span class="token keyword">int</span> <span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// default 1; 不添加default值使用该注解时必须要传入传入</span>
     String <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> <span class="token comment">//如果只有value()这一个属性需要赋值的话，可以省略键值对传值</span>
     <span class="token comment">// Integer id() default 1; //抛出异常，Invalid type</span>
  <span class="token punctuation">}</span>
</code></pre></div><ul><li>@interface表示该类是一个注解，并实现了<code>Annotation接口</code>。</li> <li>@Target表示该注解可以修饰的类型；如果不填，则此注解可以使用任何元素之上；</li> <li>@Retention用来定义注解在哪一个级别可用，是源码中可见、编译器可见还是VM可见；如果不填，默认级别是CLASS。</li> <li>注解元素可用的类型
所有基本类型（int,float,boolean,byte,double,char,long,short)、 String、Class、enum、Annotation和以上类型的数组；其它的值都会抛出<code>Error： 注释值不是允许的类型</code>。</li> <li>注解的快捷方式
当注解内元素方法名为value()时，<strong>并且该元素是唯一一个需要赋值的值</strong>(另外的值有默认值)，可以不用使用键值对来传值，直接使用<code>@MyAnnotation(&quot;2&quot;)</code>传值；如果有两个，则要使用<code>@MyAnnotation(id=1,value = &quot;2&quot;)</code>来传值。</li></ul> <p>其中根据<strong>注解参数的个数</strong>，我们可以将注解分为：标记注解、单值注解、完整注解三类。</p> <p>其实在Java目前内置了三种<strong>标准注解</strong>（详见前面表格）和四种<strong>元注解</strong>。元注解专职负责注解其他的注解，以下是四种元注解的介绍：</p> <h3 id="元注解"><a href="#元注解" aria-hidden="true" class="header-anchor">#</a> 元注解</h3> <table><thead><tr><th style="text-align:left">注解标识</th> <th>作用</th></tr></thead> <tbody><tr><td style="text-align:left">@Target</td> <td>表示注解可以用在什么地方<br>ElementType：<br>- CONSTRUCTOR 构造器的声明<br>- FIELD：域声明<br>- LOCAL_VARIABLE：局部变量声明<br>- METHOD：方法声明<br>- PACKAGE：包声明<br>- PARAMETER：方法声明<br>- TYPE：类、接口（包含注解类型）、enum</td></tr> <tr><td style="text-align:left">@Retention</td> <td>表示需要在什么级别保存该注解信息<br>RetentionPolicy：<br>- SOURCE：注解将被编译器丢弃<br>- CLASS：注解在Class文件中可用，但被VM丢弃<br>- RUNTIME：VM将在运行期间保留。可以通过反射得到注解信息</td></tr> <tr><td style="text-align:left">@Documented</td> <td>将些注解包含在Javadoc中</td></tr> <tr><td style="text-align:left">@Inherited</td> <td>允许子类继承父类的注解</td></tr></tbody></table> <p>在Java中实现注解一般是按照以下步骤：定义注解—&gt;实现注解处理器—&gt;使用注解。注解处理器的实现方式分为两种，一种是用反射的方式实现，另一种则是使用apt工具实现，下面我们通过例子来学习。</p> <h1 id="编写注解处理器"><a href="#编写注解处理器" aria-hidden="true" class="header-anchor">#</a> 编写注解处理器</h1> <h2 id="准备工作"><a href="#准备工作" aria-hidden="true" class="header-anchor">#</a> 准备工作</h2> <p>在编写注解处理器之前我们需要知道注解的一些规则；</p> <ol><li><p><strong>注解可以使用的元素</strong></p> <ul><li>所有基本类型（int、float、boolean等）。</li> <li>String</li> <li>Class</li> <li>enum</li> <li>Annotation</li> <li>以上类型的数组</li></ul></li> <li><p><strong>默认值限制</strong></p></li></ol> <p>编译器对元素的默认值有些过分挑剔，首先<strong>元素不能有不确定的值</strong>，即元素必须要么有默认值，要么在使用注解的时候提供元素的值。</p> <p>其次，对于非基本类型的元素，无论是在源码声明时，或者是在注解接口中定义默认值时，都不能用null作为其值。这个约束使得处理器很难表现一个元素的存在或者缺失的状态，因为在每个注解的声明中，所有的元素都存在并且具有相应的值，那么我们怎么样表现元素的存在或缺失状态呢？我们可以定义一些特殊值，例如空字符串或者负数，用以表示某个元素不存在。</p> <ol start="3"><li><p><strong>注解不支持继承</strong></p> <p>不能使用关键字extends来继承某个@interface。</p></li></ol> <h2 id="使用反射方式实现"><a href="#使用反射方式实现" aria-hidden="true" class="header-anchor">#</a> 使用反射方式实现</h2> <ol><li><p>定义一个ReflectAnnotation注解:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">.</span>METHOD<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">ReflectAnnotation</span> <span class="token punctuation">{</span>
   String <span class="token function">author</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;luzhangfei&quot;</span><span class="token punctuation">;</span>
   String <span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> <span class="token function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>使用反射的方式实现注解处理器：</p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflecAnnotationTracker</span> <span class="token punctuation">{</span>
     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">trackerReflectAnnotation</span><span class="token punctuation">(</span>Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">&gt;</span> cl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">//getDeclaredMethods 反射方法,获取cl类中所有的方法</span>
         <span class="token keyword">for</span> <span class="token punctuation">(</span>Method method <span class="token operator">:</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             <span class="token comment">//getAnnotation()方法返回指定的类型的注解对象</span>
             ReflectAnnotation reflectAnnotation <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span>ReflectAnnotation<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">if</span> <span class="token punctuation">(</span>reflectAnnotation <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                 <span class="token function">sys</span><span class="token punctuation">(</span><span class="token string">&quot;ReflectAnnotation:---&gt;author:&quot;</span> <span class="token operator">+</span> reflectAnnotation<span class="token punctuation">.</span><span class="token function">author</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;,date:&quot;</span> <span class="token operator">+</span> reflectAnnotation<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;,version:&quot;</span> <span class="token operator">+</span> reflectAnnotation<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>

     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sys</span><span class="token punctuation">(</span>String detail<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>detail<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div></li> <li><p>测试类：</p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>
     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         ReflecAnnotationTracker<span class="token punctuation">.</span><span class="token function">trackerReflectAnnotation</span><span class="token punctuation">(</span>Client<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token annotation punctuation">@ReflectAnnotation</span><span class="token punctuation">(</span>author <span class="token operator">=</span> <span class="token string">&quot;luzhangfei&quot;</span><span class="token punctuation">,</span> date <span class="token operator">=</span> <span class="token string">&quot;2018-08-27&quot;</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">allTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token punctuation">}</span>

     <span class="token comment">//因为author提供了默认值所以这里可以不使用</span>
     <span class="token annotation punctuation">@ReflectAnnotation</span><span class="token punctuation">(</span>date <span class="token operator">=</span> <span class="token string">&quot;2018-08-28&quot;</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
     <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token punctuation">}</span>

     <span class="token comment">//因为author、version提供了默认值所以这里可以不使用  因为Date没有提供默认值,所以必须对date进行赋值</span>
     <span class="token annotation punctuation">@ReflectAnnotation</span><span class="token punctuation">(</span>date <span class="token operator">=</span> <span class="token string">&quot;2018-08-28&quot;</span><span class="token punctuation">)</span>
     <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div></li></ol></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/luzhangfei/LuNote/edit/master/docs/Java/1_annotations.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">5/7/2019, 7:20:17 PM</span></div></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/Java/2_reflect.html">
          反射
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/6.1efe7eb3.js" defer></script><script src="/assets/js/app.87228582.js" defer></script>
  </body>
</html>
